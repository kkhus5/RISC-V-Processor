# Specify Global Variables
technology.asap7.extracted_tarballs_dir: "<YOUR_LAB_ROOT_DIRECTORY>/phys-impl/tech-asap7-cache/extracted/"
riscv.clockPeriod: &CLK_PERIOD "10ns"
riscv.simClockPeriod : &SIM_CLK_PERIOD "CLOCK_PERIOD=10"
riscv.simInputDelay : &SIM_INPUT_DELAY "INPUT_DELAY=2"
riscv.simOptions: &SIM_OPTIONS
  - "-notice"
  - "-PP"
  - "-line"
  - "+lint=all,noVCDE,noTFIPC,noIWU,noOUDPE"
  - "+v2k"
  - "-debug"
  - "+vcs+initreg+0"
  - "+vcs+initmem+0"
  - "+vcs+lic+wait"
  - "+udpsched"
  - "+evalorder"
  - "+neg_tchk"
  - "+sdfverbose"
  - "-negdelay"
riscv.verilogSrc: &VERILOG_SRC
  - "src/ALUdec.v"
  - "src/ALU.v"
  - "src/controller.v"
  - "src/datapath.v"
  - "src/Memory141.v"
  - "src/Riscv141.v"
  - "src/riscv_arbiter.v"
  - "src/riscv_top.v"
  # add the rest of your Synthesis verilog files here, including cache and all the peripheral modules you made for your datapath
riscv.simVerilogSrc: &SIM_VERILOG_SRC
  - "<YOUR_LAB_ROOT_DIRECTORY>/phys-impl/src/riscv_test_harness.v"
  - "<YOUR_LAB_ROOT_DIRECTORY>/phys-impl/src/backup_mem.v"
  - "<YOUR_LAB_ROOT_DIRECTORY>/phys-impl/src/sram.v"
  # Do NOT add any more sources here


# Power Straps
par.power_straps_mode: generate
par.generate_power_straps_method: by_tracks
par.blockage_spacing: 2.0
par.generate_power_straps_options:
  by_tracks:
    strap_layers:
      - M3
      - M4
      - M5
      - M6
      - M7
      - M8
      - M9
    pin_layers:
      - M9
        #track_width: 7 # minimum allowed for M2 & M3
    track_width: 7 
    track_spacing: 0
    track_spacing_M3: 2 # to avoid M2 shorts at higher density
    track_start: 10
    power_utilization: 0.05
    power_utilization_M8: 1.0
    power_utilization_M9: 1.0

# Placement Constraints
vlsi.inputs.placement_constraints:
  - path: "riscv_top"
    type: toplevel
    x: 0
    y: 0
    width: 500
    height: 400
    margins:
      left: 0
      right: 0
      top: 0
      bottom: 0
  - path: "riscv_top/mem/icache/tag"
    type: hardmacro
    x: 20
    y: 54
    width: 134.536
    height: 100
    orientation: r0
    top_layer: M4
  - path: "riscv_top/mem/icache/data"
    type: hardmacro
    x: 120
    y: 54
    width: 134.536
    height: 100
    orientation: r0
    top_layer: M4
  - path: "riscv_top/mem/dcache/tag"
    type: hardmacro
    x: 220
    y: 54
    width: 134.536
    height: 100
    orientation: r0
    top_layer: M4
  - path: "riscv_top/mem/dcache/data"
    type: hardmacro
    x: 320
    y: 54
    width: 134.536
    height: 100
    orientation: r0
    top_layer: M4
  - path: "riscv_top/place_obs_bottom"
    type: obstruction
    obs_types: ["place"]
    x: 0
    y: 0
    width: 500
    height: 1.08 # 1 core site tall, necessary to avoid shorts
# Pin placement constraints
vlsi.inputs.pin_mode: generated
vlsi.inputs.pin.generate_mode: semi_auto
vlsi.inputs.pin.assignments: [
  {pins: "*", layers: ["M5", "M7"], side: "bottom"}
]

par.innovus.use_cco: true

sim.inputs.timing_annotated: false

sim.inputs.level: "gl"

sim.inputs.input_files: *SIM_VERILOG_SRC

sim.inputs.input_files_meta: "append"

sim.inputs:
  timescale: "1ns/10ps"
  options: *SIM_OPTIONS
  top_module: "riscv_top"
  tb_name: "rocketTestHarness"
  tb_dut: "dut"
  execute_sim: false
  defines: 
    - *SIM_CLK_PERIOD
    - *SIM_INPUT_DELAY
    - "DEBUG"

